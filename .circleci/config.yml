{
   "jobs" : {
     "build1": {
       "machine" : {
                 "enabled" : true
       },
       "steps": [
         "checkout",
         {"run":{"command":"ip route   "}},
         {"run":{"command":"docker version"}},
         {"run":{"command":"docker run -it quay.io/wakaba/docker-perl-app-base curl host.docker.internal"}},
         {"run":{"command":"echo pp${ABC}qq"}},
         {"run":{"command":"make test2"}},
         {"run": {"command": "echo 1; mkdir -p /tmp/abc/foo; echo 1 > /tmp/abc/foo/aaa.txt; echo CCCC > c.txt"}},
         {"run": {"command": "docker build -t dockertest1 docker"}},
         {"run": {"command": "docker save -o /tmp/abc/foo/dockertest1.tar dockertest1"}},
         {"persist_to_workspace": {
           "root": "/tmp/abc",
           "paths": ["foo", "aaa", "12334", "aa/bb", "c.txt"]
         }},
         {"persist_to_workspace": {
           "root": "./",
           "paths": ["foo", "aaa", "12334", "aa/bb", "c.txt"]
         }}

]
     },
     "build2": {
       "machine" : {
                 "enabled" : true
       },
       "steps": [
         "checkout",
         {"attach_workspace": {"at": "/tmp/abc"}},
         {"attach_workspace": {"at": "./"}},
         {"run": {"command": "docker load -i /tmp/abc/foo/dockertest1.tar"}},
         {"run": {"command": "echo 2; cat /tmp/abc/foo/aaa.txt"}},
         {"run": {"command": "cat c.txt"}},
         {"run": {"command": "docker run -it dockertest1"}}
       ]
     }
   },
   "version" : 2,
   "workflows" : {
      "version" : 2,
      "build": {
        "jobs": [
          {
            "build1": {
              "context": [
                "test-context-1"
              ]
            }
          },
          {"build2": {"requires": ["build1"], "filters": {"branches": {"only": "staging"}}}},
          {"build3": {"requires": ["build1"], "filters": {"branches": {"only": "build3branch"}}}}

        ]
      }
   }
}
